{% extends "base.html" %}

{% block page_title %}
InvenTree | Index
{% endblock %}

{% block content %}
<h3>InvenTree</h3>
<hr>

<div class="row">
    <div class="col-sm-6">
        {% include "InvenTree/latest_parts.html" with collapse_id="latest_parts" %}
    </div>
    <div class="col-sm-6">
        {% include "InvenTree/bom_invalid.html" with collapse_id="bom_invalid" %}
    </div>
</div>

<div class="row">
    <div class="col-sm-6">
        {% include "InvenTree/starred_parts.html" with collapse_id="starred" %}
    </div>
    <div class="col-sm-6">
        {% include "InvenTree/low_stock.html" with collapse_id="order" %}
    </div>
</div>

<div class="row">
    <div class="col-sm-6">
        {% include "InvenTree/build_pending.html" with collapse_id="build_pending" %}
    </div>
    <div class="col-sm-6">
    </div>
</div>

{% endblock %}

{% block js_load %}
{{ block.super }}
{% endblock %}

{% block js_ready %}

{{ block.super }}

loadPartTable("#latest-parts-table", "{% url 'api-part-list' %}", {
    params: {
        "latest_parts": true,
    }
});

loadPartTable("#bom-invalid-table", "{% url 'api-part-list' %}", {
    params: {
        "bom_invalid": true,
    }
});

loadPartTable("#starred-parts-table", "{% url 'api-part-list' %}", {
    params: {
        "starred": true,
    }
});

loadPartTable("#low-stock-table", "{% url 'api-part-list' %}", {
    params: {
        "low_stock": true,
    }
});

loadBuildTable("#build-pending-table", {
    url: "{% url 'api-build-list' %}",
    params: {
        "part_detail": true,
        "status": "10-20",
    }
});

$("#bom-invalid-table").on('load-success.bs.table', function() {
    var count = $("#bom-invalid-table").bootstrapTable('getData').length;

    $("#bom-invalid-count").html(count);
});


$("#latest-parts-table").on('load-success.bs.table', function() {
    var count = $("#latest-parts-table").bootstrapTable('getData').length;

    $("#latest-parts-count").html(count);
});

$("#starred-parts-table").on('load-success.bs.table', function() {
    var count = $("#starred-parts-table").bootstrapTable('getData').length;

    $("#starred-parts-count").html(count);
});

$("#low-stock-table").on('load-success.bs.table', function() {
    var count = $("#low-stock-table").bootstrapTable('getData').length;

    $("#low-stock-count").html(count);
});

$("#build-pending-table").on('load-success.bs.table', function() {
    var count = $("#build-pending-table").bootstrapTable('getData').length;

    $("#build-pending-count").html(count);
});


{% endblock %}