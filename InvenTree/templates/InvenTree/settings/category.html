{% extends "InvenTree/settings/settings.html" %}
{% load i18n %}

{% block tabs %}
{% include "InvenTree/settings/tabs.html" with tab='category' %}
{% endblock %}

{% block subtitle %}
{% trans "Category Settings" %}
{% endblock %}

{% block settings %}

<form action="{% url 'settings-category' %}" method="post">
    {% csrf_token %}
    {% load crispy_forms_tags %}
    {% crispy form %}
</form>

{% if category %}
<hr>

<h4>{% trans "Category Parameter Templates" %}</h4>

<div id='param-buttons'>
    <button class='btn btn-success' id='new-param'>
        <span class='fas fa-plus-circle'></span> {% trans "New Parameter" %}
    </button>
</div>

<table class='table table-striped table-condensed' id='param-table' data-toolbar='#param-buttons'>
</table>
{% endif %}
{% endblock %}

{% block js_ready %}
{{ block.super }}
{% if category %}

	$("#param-table").inventreeTable({
        url: "{% url 'api-part-category-parameters' category %}",
        queryParams: {
            ordering: 'name',
        },
        formatNoMatches: function() { return '{% trans "No category parameter templates found" %}'; },
        columns: [
            {
                field: 'pk',
                title: 'ID',
                visible: false,
                switchable: false,
            },
            {
                field: 'parameter_template_detail.name',
                title: 'Parameter Template',
                sortable: 'true',
            },
            {
                field: 'default_value',
                title: 'Default Value',
                sortable: 'true',
            },
        ]
    });


	$("#new-param").click(function() {
        launchModalForm("{% url 'category-param-template-create' category %}", {
            success: function() {
                $("#param-table").bootstrapTable('refresh');
            },
        });
    });

{% endif %}
{% endblock %}
