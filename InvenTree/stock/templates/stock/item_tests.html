{% extends "stock/item_base.html" %}

{% load static %}
{% load i18n %}

{% block details %}

{% include "stock/tabs.html" with tab='tests' %}

<h4>{% trans "Test Results" %}</h4>
<hr>

<div id='button-toolbar'>
    <div class='button-toolbar container-fluid' style="float: right;">
        <div class='btn-group' role='group'>
            <button type='button' class='btn btn-success' id='add-test-result'>{% trans "Add Test Data" %}</button>
        </div>
        <div class='filter-list' id='filter-list-stocktests'>
            <!-- Empty div -->
        </div>
    </div>
</div>

<table class='table table-striped table-condensed' data-toolbar='#button-toolbar' id='test-result-table'></table>

{% endblock %}

{% block js_ready %}
{{ block.super }}

loadStockTestResultsTable(
    $("#test-result-table"), {
        params: {
            stock_item: {{ item.id }},
            user_detail: true,
            attachment_detail: true,
        },
    }
);

function reloadTable() {
    $("#test-result-table").bootstrapTable("refresh");
}

$("#add-test-result").click(function() {
    launchModalForm(
        "{% url 'stock-item-test-create' %}", {
            data: {
                stock_item: {{ item.id }},
            },
            success: reloadTable,
        }
    );
});

$("#test-result-table").on('click', '.button-test-edit', function() {
    var button = $(this);

    var url = `/stock/item/test/${button.attr('pk')}/edit/`;

    launchModalForm(url, {
        success: reloadTable,
    });
});

$("#test-result-table").on('click', '.button-test-delete', function() {
    var button = $(this);

    var url = `/stock/item/test/${button.attr('pk')}/delete/`;

    launchModalForm(url, {
        success: reloadTable,
    });
});

{% endblock %}