{% extends "part/part_base.html" %}
{% load static %}

{% block details %}

{% include 'part/tabs.html' with tab='attachments' %}

<h4>Attachments</h4>

<div id='toolbar' class='btn-group'>
    <button type='button' class='btn btn-success' id='new-attachment'>Add Attachment</button>
</div>

<table class='table table-striped table-condensed' data-toolbar='#toolbar' id='attachment-table'>
<tr>
    <th>File</th>
    <th>Comment</th>
    <th></th>
</tr>
{% for attachment in part.attachments.all %}
<tr>
    <td><a href='/media/{{ attachment.attachment }}'>{{ attachment.basename }}</a></td>
    <td>{{ attachment.comment }}</td>
    <td>
        <div class='btn-group' style='float: right;'>    
            <button type='button' class='btn btn-primary attachment-edit-button' url="{% url 'part-attachment-edit' attachment.id %}" data-toggle='tooltip' title='Edit attachment ({{ attachment.basename }})'>Edit</button>
            <button type='button' class='btn btn-danger attachment-delete-button' url="{% url 'part-attachment-delete' attachment.id %}" data-toggle='tooltip' title='Delete attachment ({{ attachment.basename }})'>Delete</button>
        </div>
    </td>
</tr>
{% endfor %}
</table>

{% endblock %}

{% block js_ready %}
{{ block.super }}

    $("#new-attachment").click(function() {
        launchModalForm("{% url 'part-attachment-create' %}?part={{ part.id }}");
    });

    $("#attachment-table").on('click', '.attachment-edit-button', function() {
        var button = $(this);

        launchModalForm(button.attr('url'), 
            {
                success: function() {
            }
        });
    });

    $("#attachment-table").on('click', '.attachment-delete-button', function() {
        var button = $(this);

        launchDeleteForm(button.attr('url'), {
            success: function() {
            }
        });
    });

{% endblock %}