{% extends "part/part_base.html" %}
{% load static %}
{% block details %}

{% include 'part/tabs.html' with tab='stock' %}

<div class='row'>
    <div class='col-sm-6'>
        <h4>Part Stock</h4>
    </div>
    <div class='col-sm-6'>
    </div>
</div>
<hr>

{% include "stock_table.html" %}

{% endblock %}

{% block js_load %}
{{ block.super }}
{% endblock %}
{% block js_ready %}
{{ block.super }}

    $('#add-stock-item').click(function () {
        launchModalForm(
                        "{% url 'stock-item-create' %}",
                        {
                            reload: true,
                            data: {
                                part: {{ part.id }}
                            }
                        });
    });

    loadStockTable($("#stock-table"), {
        params: {
            part: {{ part.id }},
        },
        buttons: [
            '#stock-options',
        ],
        url: "{% url 'api-stock-list' %}",
    });

    function selectedStock() {
        return $("#stock-table").bootstrapTable('getSelections');
    }

    $("#multi-item-move").click(function() {

        var items = selectedStock();

        moveStockItems(items,
                  {
                      success: function() {
                          $("#stock-table").bootstrapTable('refresh');
                      }
                  });

        return false;
    });

    $("#multi-item-stocktake").click(function() {
        updateStockItems({
            action: 'stocktake'
        });
        return false;
    });

    $("#multi-item-remove").click(function() {
        updateStockItems({
            action: 'remove',
        });
        return false;
    });

    $("#multi-item-add").click(function() {
        updateStockItems({
            action: 'add',
        });
        return false;
    })

{% endblock %}