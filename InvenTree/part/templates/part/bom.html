{% extends "part/part_base.html" %}
{% load static %}
{% block details %}

{% include 'part/tabs.html' with tab='bom' %}

<div class='modal fade' id='modal-form'>
    <div class='modal-dialog'>
        <div class='modal-content'>
        </div>
    </div>
</div>

<h3>Bill of Materials</h3>

<table class="table table-striped">
<tr>
    <th>Part</th>
    <th>Description</th>
    <th>Quantity</th>
    <th>Edit</th>
</tr>
{% for bom_item in part.bom_items.all %}
{% with sub_part=bom_item.sub_part %}
<tr>
    <td><a href="{% url 'part-detail' sub_part.id %}">{{ sub_part.name }}</a></td>
    <td>{{ sub_part.description }}</td>
    <td>{{ bom_item.quantity }}</td>
    <td>
        <button type='button' url="{% url 'bom-item-edit' bom_item.id %}" class='btn btn-success edit-row-button'>Edit</button>
    </td>
</tr>
{% endwith %}
{% endfor %}
</table>

<div class='container-fluid'>
    <button type='button' class='btn btn-success' id='new-bom-item'>Add BOM Item</button>
</div>

{% endblock %}

{% block javascript %}

<script type='text/javascript' src="{% static 'script/modal_form.js' %}"></script>

<script type='text/javascript'>
    $(".edit-row-button").click(function () {
        var button = $(this);

        launchModalForm("#modal-form",
                        button.attr('url'));

    });

    $("#new-bom-item").click(function () {
        launchModalForm("#modal-form",
                        "{% url 'bom-item-create' %}/?parent={{ part.id }}");
    });
</script>

{% endblock %}