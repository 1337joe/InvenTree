{% extends "base.html" %}
{% load static %}
{% block content %}


<h4>Active Builds</h4>

<div id='active-build-toolbar'>
    <div class='btn-group'>
        <button class="btn btn-success" id='new-build'>Start New Build</button>
    </div>
</div>

<table class='table table-striped table-condensed build-table' id='build-table-{{collapse_id}}' data-toolbar='#active-build-toolbar'>
        <thead>
        <tr>
            <th>Build</th>
            <th>Part</th>
            <th>Quantity</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody>
{% for build in active %}
<tr>
    <td><a href="{% url 'build-detail' build.id %}">{{ build.title }}</a></td>
    <td><a href="{% url 'part-build' build.part.id %}">{{ build.part.name }}</a></td>
    <td>{{ build.quantity }}</td>
    <td>{% include "build_status.html" with build=build %}
</tr>
{% endfor %}
</tbody>
</table>

<p></p>
{% include "build/build_list.html" with builds=completed title="Completed Builds" collapse_id="complete" %}
<p></p>
{% include "build/build_list.html" with builds=cancelled title="Cancelled Builds" collapse_id="cancelled" %}

{% include 'modals.html' %}

{% endblock %}

{% block js_ready %}
{{ block.super }}
    $("#new-build").click(function() {
        launchModalForm(
                        "{% url 'build-create' %}",
                        {
                            follow: true
                        });
    });

    $(".build-table").bootstrapTable({
        sortable: true,
        search: true,
        formatNoMatches: function() { return 'No builds found'; },
        columns: [
            {
                field: 'name',
                title: 'Build',
                sortable: true,
            },
            {
                field: 'part',
                title: 'Part',
                sortable: true,
            },
            {
                title: 'Quantity',
                sortable: true,
                searchable: false
            },
            {
                title: 'Status',
                sortable: true,
            }
        ]
    });

{% endblock %}